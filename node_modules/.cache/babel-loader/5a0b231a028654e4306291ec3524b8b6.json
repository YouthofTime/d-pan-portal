{"remainingRequest":"E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\node_modules\\babel-loader\\lib\\index.js!E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\src\\components\\buttons\\download-button\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\src\\components\\buttons\\download-button\\index.vue","mtime":1710063487650},{"path":"E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRTovc29mdHdhcmUvZG93bmxvYWQvci1wYW4tc2NhZmZvbGRpbmctbWFzdGVyL3ItcGFuLXNjYWZmb2xkaW5nLW1hc3Rlci9yLXBhbi1wb3J0YWwvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgcGFuVXRpbCBmcm9tICcuLi8uLi8uLi91dGlscy9jb21tb24nOwppbXBvcnQgeyBnZXRUb2tlbiB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL2Nvb2tpZSc7CmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdEb3duTG9hZEJ1dHRvbicsCiAgY29tcG9uZW50czoge30sCiAgcHJvcHM6IHsKICAgIHJvdW5kRmxhZzogQm9vbGVhbiwKICAgIGNpcmNsZUZsYWc6IEJvb2xlYW4sCiAgICBzaXplOiBTdHJpbmcsCiAgICBpdGVtOiBPYmplY3QKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsb2FkaW5nOiBmYWxzZQogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGRvd25sb2FkRmlsZTogZnVuY3Rpb24gZG93bmxvYWRGaWxlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKCFfdGhpcy5pdGVtICYmICghX3RoaXMubXVsdGlwbGVTZWxlY3Rpb24gfHwgX3RoaXMubXVsdGlwbGVTZWxlY3Rpb24ubGVuZ3RoID09PSAwKSkgewogICAgICAgIF90aGlzLiRtZXNzYWdlLmVycm9yKCfor7fpgInmi6nopoHkuIvovb3nmoTmlofku7YnKTsKCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoIV90aGlzLml0ZW0pIHsKICAgICAgICBmb3IgKHZhciBpID0gMCwgaUxlbmd0aCA9IF90aGlzLm11bHRpcGxlU2VsZWN0aW9uLmxlbmd0aDsgaSA8IGlMZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKF90aGlzLm11bHRpcGxlU2VsZWN0aW9uW2ldLmZvbGRlckZsYWcgPT09IDEpIHsKICAgICAgICAgICAgX3RoaXMuJG1lc3NhZ2UuZXJyb3IoJ+aWh+S7tuWkueaaguS4jeaUr+aMgeS4i+i9vScpOwoKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgX3RoaXMuZG9Eb3duTG9hZHMoX3RoaXMubXVsdGlwbGVTZWxlY3Rpb24pOwogICAgICB9CgogICAgICBpZiAoX3RoaXMuaXRlbSkgewogICAgICAgIGlmIChfdGhpcy5pdGVtLmZvbGRlckZsYWcgPT09IDEpIHsKICAgICAgICAgIF90aGlzLiRtZXNzYWdlLmVycm9yKCfmlofku7blpLnmmoLkuI3mlK/mjIHkuIvovb0nKTsKCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBfdGhpcy5kb0Rvd25sb2FkKF90aGlzLml0ZW0pOwogICAgICB9CiAgICB9LAogICAgZG9Eb3dubG9hZDogZnVuY3Rpb24gZG9Eb3dubG9hZChpdGVtKSB7CiAgICAgIHZhciB1cmwgPSBwYW5VdGlsLmdldFVybFByZWZpeCgpICsgJy9maWxlL2Rvd25sb2FkP2ZpbGVJZD0nICsgaXRlbS5maWxlSWQgKyAnJmF1dGhvcml6YXRpb249JyArIGdldFRva2VuKCksCiAgICAgICAgICBmaWxlbmFtZSA9IGl0ZW0uZmlsZW5hbWUsCiAgICAgICAgICBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgICBsaW5rLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgIGxpbmsuaHJlZiA9IHVybDsKICAgICAgbGluay5zZXRBdHRyaWJ1dGUoJ2Rvd25sb2FkJywgZmlsZW5hbWUpOwogICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspOwogICAgICBsaW5rLmNsaWNrKCk7CiAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobGluayk7CiAgICB9LAogICAgZG9Eb3duTG9hZHM6IGZ1bmN0aW9uIGRvRG93bkxvYWRzKGl0ZW1zLCBpKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAoIWkpIHsKICAgICAgICBpID0gMDsKICAgICAgfQoKICAgICAgaWYgKGl0ZW1zLmxlbmd0aCA9PT0gaSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMuZG9Eb3dubG9hZChpdGVtc1tpXSk7CgogICAgICAgIGkrKzsKCiAgICAgICAgX3RoaXMuZG9Eb3duTG9hZHMoaXRlbXMsIGkpOwogICAgICB9LCA1MDApOwogICAgfQogIH0sCiAgY29tcHV0ZWQ6IF9vYmplY3RTcHJlYWQoe30sIG1hcEdldHRlcnMoWydtdWx0aXBsZVNlbGVjdGlvbiddKSksCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHt9LAogIHdhdGNoOiB7fQp9Ow=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div class=\"download-button-content\">\n        <el-button v-if=\"roundFlag\" type=\"info\" :size=\"size\" round @click=\"downloadFile\" :loading=\"loading\">\n            下载<i class=\"el-icon-download el-icon--right\"/>\n        </el-button>\n        <el-button v-if=\"circleFlag\" type=\"info\" :size=\"size\" circle @click=\"downloadFile\" :loading=\"loading\">\n            <i class=\"el-icon-download\"/>\n        </el-button>\n    </div>\n</template>\n\n<script>\n\n    import panUtil from '../../../utils/common'\n    import { getToken } from '../../../utils/cookie'\n    import { mapGetters } from 'vuex'\n\n    export default {\n        name: 'DownLoadButton',\n        components: {},\n        props: {\n            roundFlag: Boolean,\n            circleFlag: Boolean,\n            size: String,\n            item: Object\n        },\n        data() {\n            return {\n                loading: false\n            }\n        },\n        methods: {\n            downloadFile() {\n                let _this = this\n                if (!_this.item && (!_this.multipleSelection || _this.multipleSelection.length === 0)) {\n                    _this.$message.error('请选择要下载的文件')\n                    return\n                }\n                if (!_this.item) {\n                    for (let i = 0, iLength = _this.multipleSelection.length; i < iLength; i++) {\n                        if (_this.multipleSelection[i].folderFlag === 1) {\n                            _this.$message.error('文件夹暂不支持下载')\n                            return\n                        }\n                    }\n                    _this.doDownLoads(_this.multipleSelection)\n                }\n                if (_this.item) {\n                    if (_this.item.folderFlag === 1) {\n                        _this.$message.error('文件夹暂不支持下载')\n                        return\n                    }\n                    _this.doDownload(_this.item)\n                }\n            },\n            doDownload(item) {\n                let url = panUtil.getUrlPrefix() + '/file/download?fileId=' + item.fileId + '&authorization=' + getToken(),\n                    filename = item.filename,\n                    link = document.createElement('a')\n                link.style.display = 'none'\n                link.href = url\n                link.setAttribute('download', filename)\n                document.body.appendChild(link)\n                link.click()\n                document.body.removeChild(link)\n            },\n            doDownLoads(items, i) {\n                let _this = this\n                if (!i) {\n                    i = 0\n                }\n                if (items.length === i) {\n                    return\n                }\n                setTimeout(function () {\n                    _this.doDownload(items[i]);\n                    i++\n                    _this.doDownLoads(items, i)\n                }, 500);\n            }\n        },\n        computed: {\n            ...mapGetters(['multipleSelection'])\n        },\n        mounted() {\n        },\n        watch: {}\n    }\n</script>\n\n<style>\n\n    .download-button-content {\n        display: inline-block;\n        margin-right: 10px;\n    }\n\n</style>"],"sourceRoot":"src/components/buttons/download-button"}]}