{"remainingRequest":"E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\src\\views\\preview\\video\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\src\\views\\preview\\video\\index.vue","mtime":1710063489228},{"path":"E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgppbXBvcnQgUGFuU2ltcGxlSGVhZGVyIGZyb20gJy4uLy4uLy4uL2NvbXBvbmVudHMvc2ltcGxlLWhlYWRlcicKaW1wb3J0IGZpbGVTZXJ2aWNlIGZyb20gJy4uLy4uLy4uL2FwaS9maWxlJwppbXBvcnQgcGFuVXRpbCBmcm9tICcuLi8uLi8uLi91dGlscy9jb21tb24nCgpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAnVmlkZW8nLAogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICB2aWRlb05hbWU6ICcnLAogICAgICAgICAgICBhY3RpdmVJbmRleDogJycsCiAgICAgICAgICAgIHZpZGVvU2hvd1BhdGg6ICcnLAogICAgICAgICAgICB2aWRlb0xpc3Q6IFtdCiAgICAgICAgfQogICAgfSwKICAgIGNvbXBvbmVudHM6IHsgUGFuU2ltcGxlSGVhZGVyIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgaW5pdCgpIHsKICAgICAgICAgICAgbGV0IF90aGlzID0gdGhpcwogICAgICAgICAgICBmaWxlU2VydmljZS5saXN0KHsKICAgICAgICAgICAgICAgIHBhcmVudElkOiBfdGhpcy4kcm91dGUucGFyYW1zLnBhcmVudElkLAogICAgICAgICAgICAgICAgZmlsZVR5cGVzOiAnOScKICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDApIHsKICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZW5kZXJWaWRlb0xpc3QocmVzLmRhdGEpCiAgICAgICAgICAgICAgICAgICAgX3RoaXMubGlzdGVuVmlkZW9QbGF5ZXIoKQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBfdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubWVzc2FnZSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycikgewogICAgICAgICAgICAgICAgX3RoaXMuJG1lc3NhZ2UuZXJyb3IoZXJyKQogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgc2VsZWN0VmlkZW8oaW5kZXgpIHsKICAgICAgICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IGluZGV4CiAgICAgICAgICAgIHRoaXMudmlkZW9MaXN0LnNvbWUoaXRlbSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoaXRlbS5maWxlSWQgPT09IGluZGV4KSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy52aWRlb05hbWUgPSBpdGVtLmZpbGVOYW1lCiAgICAgICAgICAgICAgICAgICAgdGhpcy52aWRlb1Nob3dQYXRoID0gcGFuVXRpbC5nZXRQcmV2aWV3VXJsKGl0ZW0uZmlsZUlkKQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICByZW5kZXJWaWRlb0xpc3QoZGF0YUxpc3QpIHsKICAgICAgICAgICAgbGV0IF90aGlzID0gdGhpcwogICAgICAgICAgICBfdGhpcy52aWRlb0xpc3QgPSBuZXcgQXJyYXkoKQogICAgICAgICAgICBkYXRhTGlzdC5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4gewogICAgICAgICAgICAgICAgaXRlbS5maWxlbmFtZSA9IGl0ZW0uZmlsZW5hbWUuc3Vic3RyaW5nKDAsIGl0ZW0uZmlsZW5hbWUubGFzdEluZGV4T2YoJy4nKSkKICAgICAgICAgICAgICAgIGlmIChpdGVtLmZpbGVuYW1lLmxlbmd0aCA+IDE1KSB7CiAgICAgICAgICAgICAgICAgICAgaXRlbS5maWxlbmFtZSA9IGl0ZW0uZmlsZW5hbWUuc3Vic3RyaW5nKDAsIDE2KSArICcuLi4nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoaXRlbS5maWxlSWQgPT09IF90aGlzLiRyb3V0ZS5wYXJhbXMuZmlsZUlkKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMudmlkZW9OYW1lID0gaXRlbS5maWxlbmFtZQogICAgICAgICAgICAgICAgICAgIF90aGlzLnZpZGVvU2hvd1BhdGggPSBwYW5VdGlsLmdldFByZXZpZXdVcmwoaXRlbS5maWxlSWQpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfdGhpcy52aWRlb0xpc3QucHVzaChpdGVtKQogICAgICAgICAgICAgICAgX3RoaXMuYWN0aXZlSW5kZXggPSBfdGhpcy4kcm91dGUucGFyYW1zLmZpbGVJZAogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgbGlzdGVuVmlkZW9QbGF5ZXIoKSB7CiAgICAgICAgICAgIGxldCBfdGhpcyA9IHRoaXMKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JfcGFuX3ZpZGVvX3BsYXllcicpLmFkZEV2ZW50TGlzdGVuZXIoJ2VuZGVkJywgKCkgPT4gewogICAgICAgICAgICAgICAgX3RoaXMuc2VsZWN0TmV4dChfdGhpcy5hY3RpdmVJbmRleCkKICAgICAgICAgICAgfSwgZmFsc2UpCiAgICAgICAgfSwKICAgICAgICBzZWxlY3ROZXh0KGN1cnJlbnRGaWxlSWQpIHsKICAgICAgICAgICAgbGV0IGkKICAgICAgICAgICAgdGhpcy52aWRlb0xpc3Quc29tZSgoaXRlbSwgaW5kZXgpID0+IHsKICAgICAgICAgICAgICAgIGlmIChpdGVtLmZpbGVJZCA9PT0gY3VycmVudEZpbGVJZCkgewogICAgICAgICAgICAgICAgICAgIGkgPSBpbmRleAogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIGlmIChpID09PSB0aGlzLnZpZGVvTGlzdC5sZW5ndGggLSAxKSB7CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBsZXQgaXRlbSA9IHRoaXMudmlkZW9MaXN0WysraV0KICAgICAgICAgICAgdGhpcy52aWRlb05hbWUgPSBpdGVtLmZpbGVuYW1lCiAgICAgICAgICAgIHRoaXMudmlkZW9TaG93UGF0aCA9IHBhblV0aWwuZ2V0UHJldmlld1VybChpdGVtLmZpbGVJZCkKICAgICAgICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IGl0ZW0uZmlsZUlkCiAgICAgICAgfQogICAgfSwKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgLy/noa7kv53pobXpnaLlhYPntKDliqDovb3lrozmiJDkuYvlkI7osIPnlKgKICAgICAgICB0aGlzLmluaXQoKQogICAgfSwKICAgIHdhdGNoOiB7fQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/preview/video","sourcesContent":["/**\n* Created by rubin on 2020/7/5.\n*/\n\n<template>\n    <div>\n        <pan-simple-header/>\n        <div class=\"pan-video-content\">\n            <div class=\"video-name-content\">\n                <p class=\"video-name\">{{ videoName }}</p>\n            </div>\n            <el-divider></el-divider>\n            <el-row>\n                <el-col :span=\"18\">\n                    <!--视频播放容器-->\n                    <div class=\"video-content\">\n                        <video id=\"r_pan_video_player\" :src=\"videoShowPath\" autoplay=\"true\" controls=\"true\"/>\n                    </div>\n                </el-col>\n                <el-col :span=\"6\">\n                    <div class=\"video-list-content\">\n                        <el-menu class=\"video-list\"\n                                 :default-active=\"activeIndex\"\n                                 @select=\"selectVideo\">\n                            <el-menu-item v-for=\"(item, index) in videoList\" :key=\"index\" :index=\"item.fileId\">\n                                <i class=\"fa fa-video-camera\"></i>\n                                <span slot=\"title\">{{ item.filename }}</span>\n                            </el-menu-item>\n                        </el-menu>\n                    </div>\n                </el-col>\n            </el-row>\n        </div>\n    </div>\n</template>\n\n<script>\n\n    import PanSimpleHeader from '../../../components/simple-header'\n    import fileService from '../../../api/file'\n    import panUtil from '../../../utils/common'\n\n    export default {\n        name: 'Video',\n        data() {\n            return {\n                videoName: '',\n                activeIndex: '',\n                videoShowPath: '',\n                videoList: []\n            }\n        },\n        components: { PanSimpleHeader },\n        methods: {\n            init() {\n                let _this = this\n                fileService.list({\n                    parentId: _this.$route.params.parentId,\n                    fileTypes: '9'\n                }, function (res) {\n                    if (res.status === 0) {\n                        _this.renderVideoList(res.data)\n                        _this.listenVideoPlayer()\n                    } else {\n                        _this.$message.error(res.message)\n                    }\n                }, function (err) {\n                    _this.$message.error(err)\n                })\n            },\n            selectVideo(index) {\n                this.activeIndex = index\n                this.videoList.some(item => {\n                    if (item.fileId === index) {\n                        this.videoName = item.fileName\n                        this.videoShowPath = panUtil.getPreviewUrl(item.fileId)\n                        return true\n                    }\n                })\n            },\n            renderVideoList(dataList) {\n                let _this = this\n                _this.videoList = new Array()\n                dataList.forEach((item, index) => {\n                    item.filename = item.filename.substring(0, item.filename.lastIndexOf('.'))\n                    if (item.filename.length > 15) {\n                        item.filename = item.filename.substring(0, 16) + '...'\n                    }\n                    if (item.fileId === _this.$route.params.fileId) {\n                        _this.videoName = item.filename\n                        _this.videoShowPath = panUtil.getPreviewUrl(item.fileId)\n                    }\n                    _this.videoList.push(item)\n                    _this.activeIndex = _this.$route.params.fileId\n                })\n            },\n            listenVideoPlayer() {\n                let _this = this\n                document.getElementById('r_pan_video_player').addEventListener('ended', () => {\n                    _this.selectNext(_this.activeIndex)\n                }, false)\n            },\n            selectNext(currentFileId) {\n                let i\n                this.videoList.some((item, index) => {\n                    if (item.fileId === currentFileId) {\n                        i = index\n                        return true\n                    }\n                })\n                if (i === this.videoList.length - 1) {\n                    return\n                }\n                let item = this.videoList[++i]\n                this.videoName = item.filename\n                this.videoShowPath = panUtil.getPreviewUrl(item.fileId)\n                this.activeIndex = item.fileId\n            }\n        },\n        mounted() {\n            //确保页面元素加载完成之后调用\n            this.init()\n        },\n        watch: {}\n    }\n</script>\n\n<style scoped>\n\n    .pan-video-content {\n        width: 100%;\n        margin-top: 62px;\n        display: block;\n    }\n\n    .pan-video-content .video-name-content {\n        display: block;\n        width: 100%;\n        text-align: center;\n        padding: 10px 0 0 0;\n    }\n\n    .pan-video-content .video-name-content .video-name {\n        color: #409EFF;\n        font-size: 35px;\n        font-weight: bold;\n        font-family: \"Helvetica Neue\", Helvetica, \"PingFang SC\", \"Hiragino Sans GB\", \"Microsoft YaHei\", \"微软雅黑\", Arial, sans-serif;\n    }\n\n    .pan-video-content .video-content {\n        width: 100%;\n        height: 100px;\n        display: block;\n        text-align: center;\n    }\n\n    .pan-video-content .video-content #r_pan_video_player {\n        display: inline-block;\n        width: 100%;\n        height: 500px;\n        line-height: 500px;\n    }\n\n    .pan-video-content .video-list-content {\n        display: block;\n        margin: 0 auto;\n        width: 250px;\n        height: 500px;\n        line-height: 500px;\n        overflow: hidden;\n    }\n\n    .pan-video-content .video-list-content .video-list {\n        width: 100%;\n        height: 100%;\n        overflow: scroll;\n    }\n\n    .pan-video-content .video-list i {\n        margin-right: 15px;\n    }\n\n</style>\n"]}]}