{"remainingRequest":"E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\src\\components\\buttons\\copy-button\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\src\\components\\buttons\\copy-button\\index.vue","mtime":1710063487539},{"path":"E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\software\\download\\r-pan-scaffolding-master\\r-pan-scaffolding-master\\r-pan-portal\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgppbXBvcnQgZmlsZVNlcnZpY2UgZnJvbSAnLi4vLi4vLi4vYXBpL2ZpbGUnCmltcG9ydCB7IG1hcEFjdGlvbnMsIG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JwoKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogJ0NvcHlCdXR0b24nLAogICAgY29tcG9uZW50czoge30sCiAgICBwcm9wczogewogICAgICAgIHJvdW5kRmxhZzogQm9vbGVhbiwKICAgICAgICBjaXJjbGVGbGFnOiBCb29sZWFuLAogICAgICAgIHNpemU6IFN0cmluZywKICAgICAgICBpdGVtOiBPYmplY3QKICAgIH0sCiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHRyZWVEaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgICAgICAgdHJlZURhdGE6IFtdLAogICAgICAgICAgICBsb2FkaW5nOiBmYWxzZQogICAgICAgIH0KICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgLi4ubWFwQWN0aW9ucyh7CiAgICAgICAgICAgIHJlbG9hZEZpbGVMaXN0OiAnZmlsZS9sb2FkRmlsZUxpc3QnCiAgICAgICAgfSksCiAgICAgICAgY29weUZpbGUoKSB7CiAgICAgICAgICAgIGxldCBfdGhpcyA9IHRoaXMKICAgICAgICAgICAgaWYgKCFfdGhpcy5pdGVtICYmICghX3RoaXMubXVsdGlwbGVTZWxlY3Rpb24gfHwgX3RoaXMubXVsdGlwbGVTZWxlY3Rpb24ubGVuZ3RoID09IDApKSB7CiAgICAgICAgICAgICAgICBfdGhpcy4kbWVzc2FnZS5lcnJvcign6K+36YCJ5oup6KaB5aSN5Yi255qE5paH5Lu2JykKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIF90aGlzLnRyZWVEaWFsb2dWaXNpYmxlID0gdHJ1ZQogICAgICAgIH0sCiAgICAgICAgZG9Db3B5RmlsZSh0YXJnZXRQYXJlbnRJZCkgewogICAgICAgICAgICBsZXQgX3RoaXMgPSB0aGlzLAogICAgICAgICAgICAgICAgZmlsZUlkcyA9ICcnCiAgICAgICAgICAgIGlmIChfdGhpcy5pdGVtKSB7CiAgICAgICAgICAgICAgICBmaWxlSWRzID0gX3RoaXMuaXRlbS5maWxlSWQKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGxldCBmaWxlSWRBcnIgPSBuZXcgQXJyYXkoKQogICAgICAgICAgICAgICAgX3RoaXMubXVsdGlwbGVTZWxlY3Rpb24uZm9yRWFjaChpdGVtID0+IGZpbGVJZEFyci5wdXNoKGl0ZW0uZmlsZUlkKSkKICAgICAgICAgICAgICAgIGZpbGVJZHMgPSBmaWxlSWRBcnIuam9pbignX18sX18nKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZpbGVTZXJ2aWNlLmNvcHkoewogICAgICAgICAgICAgICAgZmlsZUlkczogZmlsZUlkcywKICAgICAgICAgICAgICAgIHRhcmdldFBhcmVudElkOiB0YXJnZXRQYXJlbnRJZAogICAgICAgICAgICB9LCByZXMgPT4gewogICAgICAgICAgICAgICAgX3RoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICBfdGhpcy50cmVlRGlhbG9nVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgICAgICAgICBfdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfmlofku7blpI3liLbmiJDlip8nKQogICAgICAgICAgICAgICAgX3RoaXMucmVsb2FkRmlsZUxpc3QoKQogICAgICAgICAgICB9LCByZXMgPT4gewogICAgICAgICAgICAgICAgX3RoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICBfdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubWVzc2FnZSkKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGRvQ2hvc2VUcmVlTm9kZUNhbGxCYWNrKCkgewogICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgIGxldCBjaGVja05vZGUgPSB0aGlzLiRyZWZzLnRyZWUuZ2V0Q3VycmVudE5vZGUoKQogICAgICAgICAgICBpZiAoIWNoZWNrTm9kZSkgewogICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6K+36YCJ5oup5paH5Lu25aS5JykKICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLmRvQ29weUZpbGUoY2hlY2tOb2RlLmlkKQogICAgICAgIH0sCiAgICAgICAgcmVzZXRUcmVlRGF0YSgpIHsKICAgICAgICAgICAgdGhpcy50cmVlRGF0YSA9IG5ldyBBcnJheSgpCiAgICAgICAgfSwKICAgICAgICBsb2FkVHJlZURhdGEoKSB7CiAgICAgICAgICAgIGxldCBfdGhpcyA9IHRoaXMKICAgICAgICAgICAgZmlsZVNlcnZpY2UuZ2V0Rm9sZGVyVHJlZShyZXMgPT4gewogICAgICAgICAgICAgICAgX3RoaXMudHJlZURhdGEgPSByZXMuZGF0YQogICAgICAgICAgICB9LCByZXMgPT4gewogICAgICAgICAgICAgICAgX3RoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1lc3NhZ2UpCiAgICAgICAgICAgIH0pCiAgICAgICAgfQogICAgfSwKICAgIGNvbXB1dGVkOiB7CiAgICAgICAgLi4ubWFwR2V0dGVycyhbJ211bHRpcGxlU2VsZWN0aW9uJ10pCiAgICB9LAogICAgbW91bnRlZCgpIHsKICAgIH0sCiAgICB3YXRjaDoge30KfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0CA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/buttons/copy-button","sourcesContent":["<template>\n    <div class=\"copy-button-content\">\n        <el-button v-if=\"roundFlag\" :size=\"size\" round @click=\"copyFile\">\n            复制到\n        </el-button>\n        <el-button v-if=\"circleFlag\" icon=\"el-icon-document-copy\" :size=\"size\" circle @click=\"copyFile\">\n        </el-button>\n        <el-dialog\n                title=\"复制文件\"\n                :visible.sync=\"treeDialogVisible\"\n                @open=\"loadTreeData\"\n                @closed=\"resetTreeData\"\n                width=\"30%\"\n                :append-to-body=true\n                :modal-append-to-body=false\n                :center=true>\n            <div class=\"tree-content\">\n                <el-tree\n                        class=\"tree\"\n                        :data=\"treeData\"\n                        empty-text=\"暂无文件夹数据\"\n                        default-expand-all\n                        highlight-current\n                        check-on-click-node\n                        :expand-on-click-node=\"false\"\n                        ref=\"tree\">\n                    <span class=\"custom-tree-node\" slot-scope=\"{ node, data }\">\n                        <i class=\"fa fa-folder-o\" style=\"margin-right: 15px; font-size: 20px; cursor: pointer;\"/>\n                        <span>{{ node.label }}</span>\n                    </span>\n                </el-tree>\n            </div>\n            <span slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"treeDialogVisible = false\">取 消</el-button>\n                <el-button type=\"primary\" @click=\"doChoseTreeNodeCallBack\" :loading=\"loading\">确 定</el-button>\n            </span>\n        </el-dialog>\n    </div>\n</template>\n\n<script>\n\n    import fileService from '../../../api/file'\n    import { mapActions, mapGetters } from 'vuex'\n\n    export default {\n        name: 'CopyButton',\n        components: {},\n        props: {\n            roundFlag: Boolean,\n            circleFlag: Boolean,\n            size: String,\n            item: Object\n        },\n        data() {\n            return {\n                treeDialogVisible: false,\n                treeData: [],\n                loading: false\n            }\n        },\n        methods: {\n            ...mapActions({\n                reloadFileList: 'file/loadFileList'\n            }),\n            copyFile() {\n                let _this = this\n                if (!_this.item && (!_this.multipleSelection || _this.multipleSelection.length == 0)) {\n                    _this.$message.error('请选择要复制的文件')\n                    return\n                }\n                _this.treeDialogVisible = true\n            },\n            doCopyFile(targetParentId) {\n                let _this = this,\n                    fileIds = ''\n                if (_this.item) {\n                    fileIds = _this.item.fileId\n                } else {\n                    let fileIdArr = new Array()\n                    _this.multipleSelection.forEach(item => fileIdArr.push(item.fileId))\n                    fileIds = fileIdArr.join('__,__')\n                }\n                fileService.copy({\n                    fileIds: fileIds,\n                    targetParentId: targetParentId\n                }, res => {\n                    _this.loading = false\n                    _this.treeDialogVisible = false\n                    _this.$message.success('文件复制成功')\n                    _this.reloadFileList()\n                }, res => {\n                    _this.loading = false\n                    _this.$message.error(res.message)\n                })\n            },\n            doChoseTreeNodeCallBack() {\n                this.loading = true\n                let checkNode = this.$refs.tree.getCurrentNode()\n                if (!checkNode) {\n                    this.$message.error('请选择文件夹')\n                    this.loading = false\n                    return\n                }\n                this.doCopyFile(checkNode.id)\n            },\n            resetTreeData() {\n                this.treeData = new Array()\n            },\n            loadTreeData() {\n                let _this = this\n                fileService.getFolderTree(res => {\n                    _this.treeData = res.data\n                }, res => {\n                    _this.$message.error(res.message)\n                })\n            }\n        },\n        computed: {\n            ...mapGetters(['multipleSelection'])\n        },\n        mounted() {\n        },\n        watch: {}\n    }\n</script>\n\n<style>\n\n    .copy-button-content {\n        display: inline-block;\n        margin-right: 10px;\n    }\n\n    .tree-content {\n        height: 400px;\n    }\n\n    .tree-content .tree {\n        height: 100%;\n        overflow: auto;\n    }\n\n</style>"]}]}